---

- name: Configure /etc/hosts file of the monitoring server
  hosts: localhost
  become: yes
  vars_files:
     - "./vars/dev.yaml"

  tasks:

     - name: Get public ip of brokers
       command: " dig +short {{ item.dns }} "
       register: r
       loop: "{{ kafka.servers }}"
 
     - name: Configure hosts file
       lineinfile:
          path: ./vars/hosts
          line: " {{ item.1.stdout }} kafka{{ item.0 +1 }}"
       with_indexed_items: "{{r.results}}"
                
